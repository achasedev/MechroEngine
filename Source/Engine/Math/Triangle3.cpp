///--------------------------------------------------------------------------------------------------------------------------------------------------
/// Author: Andrew Chase
/// Date Created: Nov 16th, 2021
/// Description: 
///--------------------------------------------------------------------------------------------------------------------------------------------------

///--------------------------------------------------------------------------------------------------------------------------------------------------
/// INCLUDES
///--------------------------------------------------------------------------------------------------------------------------------------------------
#include "Engine/Core/EngineCommon.h"
#include "Engine/Math/MathUtils.h"
#include "Engine/Math/Matrix3.h"
#include "Engine/Math/Triangle2.h"
#include "Engine/Math/Triangle3.h"


///--------------------------------------------------------------------------------------------------------------------------------------------------
/// DEFINES
///--------------------------------------------------------------------------------------------------------------------------------------------------

///--------------------------------------------------------------------------------------------------------------------------------------------------
/// ENUMS, TYPEDEFS, STRUCTS, FORWARD DECLARATIONS
///--------------------------------------------------------------------------------------------------------------------------------------------------

///--------------------------------------------------------------------------------------------------------------------------------------------------
/// GLOBALS AND STATICS
///--------------------------------------------------------------------------------------------------------------------------------------------------

///--------------------------------------------------------------------------------------------------------------------------------------------------
/// C FUNCTIONS
///--------------------------------------------------------------------------------------------------------------------------------------------------

///--------------------------------------------------------------------------------------------------------------------------------------------------
/// CLASS IMPLEMENTATIONS
///--------------------------------------------------------------------------------------------------------------------------------------------------

//-------------------------------------------------------------------------------------------------
Triangle2 Triangle3::GetInPlaneRepresentation() const
{
	return Triangle2();
}


//-------------------------------------------------------------------------------------------------
Vector2 Triangle3::TransformPointInto2DBasis(const Vector3& point) const
{
	Matrix4 basisVectors;
	GetIJBasis(basisVectors);
	basisVectors.Invert();

	return basisVectors.TransformPosition(point).xy;
}


//-------------------------------------------------------------------------------------------------
Vector3 Triangle3::TransformPointOutOf2DBasis(const Vector2& point) const
{
	Matrix4 basisVectors;
	GetIJBasis(basisVectors);

	return basisVectors.iBasis.xyz() * point.x + basisVectors.jBasis.xyz() * point.y + m_a;
}


//-------------------------------------------------------------------------------------------------
void Triangle3::GetIJBasis(Matrix4& out_bases) const
{
	Vector3 i = (m_b - m_a);
	Vector3 j = (m_c - m_a);
	Vector3 k = CrossProduct(i, j);
	out_bases = Matrix4(i, j, k, m_a);
}
