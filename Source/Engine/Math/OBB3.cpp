///--------------------------------------------------------------------------------------------------------------------------------------------------
/// Author: Andrew Chase
/// Date Created: March 20th, 2021
/// Description: 
///--------------------------------------------------------------------------------------------------------------------------------------------------

///--------------------------------------------------------------------------------------------------------------------------------------------------
/// INCLUDES
///--------------------------------------------------------------------------------------------------------------------------------------------------
#include "Engine/Framework/EngineCommon.h"
#include "Engine/Math/OBB3.h"

///--------------------------------------------------------------------------------------------------------------------------------------------------
/// DEFINES
///--------------------------------------------------------------------------------------------------------------------------------------------------

///--------------------------------------------------------------------------------------------------------------------------------------------------
/// ENUMS, TYPEDEFS, STRUCTS, FORWARD DECLARATIONS
///--------------------------------------------------------------------------------------------------------------------------------------------------

///--------------------------------------------------------------------------------------------------------------------------------------------------
/// GLOBALS AND STATICS
///--------------------------------------------------------------------------------------------------------------------------------------------------

///--------------------------------------------------------------------------------------------------------------------------------------------------
/// C FUNCTIONS
///--------------------------------------------------------------------------------------------------------------------------------------------------

///--------------------------------------------------------------------------------------------------------------------------------------------------
/// CLASS IMPLEMENTATIONS
///--------------------------------------------------------------------------------------------------------------------------------------------------

//-------------------------------------------------------------------------------------------------
OBB3::OBB3(const Vector3& center, const Vector3& extents, const Vector3& rotation)
{
	m_transform = Transform(center, rotation, extents);
}


//-------------------------------------------------------------------------------------------------
OBB3::OBB3(const Matrix44& matrixRepresentation)
{
	m_transform.SetLocalMatrix(matrixRepresentation);
}


//-------------------------------------------------------------------------------------------------
Vector3 OBB3::GetRightVector() const
{
	return m_transform.GetIVector();
}


Vector3 OBB3::GetUpVector() const
{

}


Vector3 OBB3::GetForwardVector() const
{

}


//-------------------------------------------------------------------------------------------------
void OBB3::GetFaceSupportPlanes(std::vector<Plane>& out_planes) const
{
	// Find the local space extremes in world space
	Vector3 minsWs = m_transform.TransformPositionLocalToWorld(Vector3(-1.f, -1.f, -1.f));
	Vector3 maxsWs = m_transform.TransformPositionLocalToWorld(Vector3(1.f, 1.f, 1.f));

	// Normals to the faces will be along these 3 directions
	Vector3 right = m_transform.GetIVector().Normalize();
	Vector3 up = m_transform.GetJVector().Normalize();
	Vector3 forward = m_transform.GetKVector().Normalize();

	out_planes.clear();
	out_planes.push_back(Plane(-1.f * right, minsWs));
	out_planes.push_back(Plane(right, maxsWs));
	out_planes.push_back(Plane(-1.f * up, minsWs));
	out_planes.push_back(Plane(up, maxsWs));
	out_planes.push_back(Plane(-1.f * forward, minsWs));
	out_planes.push_back(Plane(forward, maxsWs));
}
