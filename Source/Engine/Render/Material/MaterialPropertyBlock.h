///--------------------------------------------------------------------------------------------------------------------------------------------------
/// Author: Andrew Chase
/// Date Created: Oct 24th, 2021
/// Description: 
///--------------------------------------------------------------------------------------------------------------------------------------------------
#pragma once

///--------------------------------------------------------------------------------------------------------------------------------------------------
/// INCLUDES
///--------------------------------------------------------------------------------------------------------------------------------------------------
#include "Engine/Render/Buffer/ConstantBuffer.h"
#include "Engine/Utility/StringID.h"

///--------------------------------------------------------------------------------------------------------------------------------------------------
/// DEFINES
///--------------------------------------------------------------------------------------------------------------------------------------------------

///--------------------------------------------------------------------------------------------------------------------------------------------------
/// ENUMS, TYPEDEFS, STRUCTS, FORWARD DECLARATIONS
///--------------------------------------------------------------------------------------------------------------------------------------------------
class PropertyBlockDescription;

///--------------------------------------------------------------------------------------------------------------------------------------------------
/// GLOBALS AND STATICS
///--------------------------------------------------------------------------------------------------------------------------------------------------

///--------------------------------------------------------------------------------------------------------------------------------------------------
/// CLASS DECLARATIONS
///--------------------------------------------------------------------------------------------------------------------------------------------------

//-------------------------------------------------------------------------------------------------
class MaterialPropertyBlock
{
public:
	//-----Public Methods-----

	MaterialPropertyBlock(const PropertyBlockDescription* description);

	void							SetCPUData(const void* data, int dataSize, int offset);
	void							UpdateGPUData();

	StringID						GetName() const;
	const PropertyBlockDescription*	GetDescription() const { return m_description; }
	ConstantBuffer*					GetConstantBuffer() { return &m_buffer; }
	MaterialPropertyBlock*			CreateClone() const;

	template <typename T>
	void SetCPUData(const T& data, size_t offset) { SetCPUData(&data, sizeof(T), offset); }


private:
	//-----Private Data-----

	void*							m_cpuData = nullptr;
	bool							m_gpuNeedsUpdate = false;

	ConstantBuffer					m_buffer;
	const PropertyBlockDescription*	m_description = nullptr;

};

///--------------------------------------------------------------------------------------------------------------------------------------------------
/// C FUNCTIONS
///--------------------------------------------------------------------------------------------------------------------------------------------------