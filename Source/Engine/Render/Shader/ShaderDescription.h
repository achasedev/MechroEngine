///--------------------------------------------------------------------------------------------------------------------------------------------------
/// Author: Andrew Chase
/// Date Created: Oct 24th, 2021
/// Description: Class to represent info for *both* vertex and fragment shaders
///--------------------------------------------------------------------------------------------------------------------------------------------------
#pragma once

///--------------------------------------------------------------------------------------------------------------------------------------------------
/// INCLUDES
///--------------------------------------------------------------------------------------------------------------------------------------------------
#include <vector>

///--------------------------------------------------------------------------------------------------------------------------------------------------
/// DEFINES
///--------------------------------------------------------------------------------------------------------------------------------------------------

///--------------------------------------------------------------------------------------------------------------------------------------------------
/// ENUMS, TYPEDEFS, STRUCTS, FORWARD DECLARATIONS
///--------------------------------------------------------------------------------------------------------------------------------------------------
struct ID3D11ShaderReflection;
class PropertyDescription;
class PropertyBlockDescription;

///--------------------------------------------------------------------------------------------------------------------------------------------------
/// GLOBALS AND STATICS
///--------------------------------------------------------------------------------------------------------------------------------------------------

///--------------------------------------------------------------------------------------------------------------------------------------------------
/// CLASS DECLARATIONS
///--------------------------------------------------------------------------------------------------------------------------------------------------

//-------------------------------------------------------------------------------------------------
class ShaderDescription
{
public:
	//-----Public Methods-----

	ShaderDescription() {}
	~ShaderDescription();

	void							Initialize(ID3DBlob* vertexSource, ID3DBlob* fragmentSource);

	const PropertyBlockDescription*	GetBlockDescriptionAtIndex(int index) const;
	const PropertyBlockDescription*	GetBlockDescriptionAtBindSlot(int bindSlot) const;
	const PropertyBlockDescription*	GetBlockDescriptionByName(const StringID& blockName) const;
	const PropertyDescription*		GetPropertyDescription(const StringID& propertyName) const;
	int								GetBlockCount() const { return (int)m_propertyBlocks.size(); }
	bool							IsValid() const { return m_dxReflector != nullptr; }


private:
	//-----Private Data-----

	ID3D11ShaderReflection*					m_dxReflector = nullptr;
	std::vector<PropertyBlockDescription*>	m_propertyBlocks;

};

///--------------------------------------------------------------------------------------------------------------------------------------------------
/// C FUNCTIONS
///--------------------------------------------------------------------------------------------------------------------------------------------------