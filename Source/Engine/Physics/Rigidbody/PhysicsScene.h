///--------------------------------------------------------------------------------------------------------------------------------------------------
/// Author: Andrew Chase
/// Date Created: May 3rd, 2021
/// Description: 
///--------------------------------------------------------------------------------------------------------------------------------------------------
#pragma once

///--------------------------------------------------------------------------------------------------------------------------------------------------
/// INCLUDES
///--------------------------------------------------------------------------------------------------------------------------------------------------
#include "Engine/Collision/BoundingVolumeHierarchy/BoundingVolume.h"
#include "Engine/Collision/CollisionScene.h"
#include "Engine/Physics/RigidBody/RigidBodyForceRegistry.h"
#include <vector>

///--------------------------------------------------------------------------------------------------------------------------------------------------
/// DEFINES
///--------------------------------------------------------------------------------------------------------------------------------------------------

///--------------------------------------------------------------------------------------------------------------------------------------------------
/// ENUMS, TYPEDEFS, STRUCTS, FORWARD DECLARATIONS
///--------------------------------------------------------------------------------------------------------------------------------------------------
class RigidBody;
class RigidBodyForceGenerator;

///--------------------------------------------------------------------------------------------------------------------------------------------------
/// GLOBALS AND STATICS
///--------------------------------------------------------------------------------------------------------------------------------------------------

///--------------------------------------------------------------------------------------------------------------------------------------------------
/// CLASS DECLARATIONS
///--------------------------------------------------------------------------------------------------------------------------------------------------

//-------------------------------------------------------------------------------------------------
class PhysicsScene
{
public:
	//-----Public Methods-----

	PhysicsScene(CollisionScene<BoundingVolumeSphere>* collisionScene);
	~PhysicsScene();

	void BeginFrame();
	void DoPhysicsStep(float deltaSeconds);

	void SetGravityAcceleration(const Vector3& gravityAcc) { m_gravityAcc = gravityAcc; }
	void AddRigidbody(RigidBody* body);
	void AddForceGenerator(RigidBodyForceGenerator* forceGen, RigidBody* body);


private:
	//-----Private Methods-----

	void Integrate(float deltaSeconds);


public:
	//-----Public Methods-----

	static const Vector3 DEFAULT_GRAVITY;


private:
	//-----Private Data-----

	Vector3									m_gravityAcc = DEFAULT_GRAVITY;
	std::vector<RigidBody*>					m_bodies;
	std::vector<RigidBodyForceGenerator*>	m_forceGens;
	RigidBodyForceRegistry					m_forceRegistry;
	CollisionScene<BoundingVolumeSphere>*	m_collisionScene = nullptr;

};

///--------------------------------------------------------------------------------------------------------------------------------------------------
/// C FUNCTIONS
///--------------------------------------------------------------------------------------------------------------------------------------------------
